{% comment %}
Template for showing preprocessing progress with a progress bar.
Polls for updates using HTMX.
{% endcomment %}

<div id="{{ container_id|default:'preprocessing-container' }}">
    <div class="progress-container">
        <div class="d-flex justify-content-between mb-2">
            <span class="text-muted">{{ spinner_text|default:"Preprocessing in progress..." }}</span>
            <span class="text-muted">{{ progress_percentage|default:0 }}%</span>
        </div>
        <div class="progress" style="height: 30px;">
            <div class="progress-bar progress-bar-striped progress-bar-animated bg-info" 
                 role="progressbar" 
                 style="width: {{ progress_percentage|default:0 }}%"
                 aria-valuenow="{{ progress_percentage|default:0 }}" 
                 aria-valuemin="0" 
                 aria-valuemax="100">
                <span style="font-size: 14px;">
                    {{ processed_items|default:0 }} / {{ total_items|default:0 }} items
                </span>
            </div>
        </div>
        <small class="text-muted d-block mt-2">
            Processing database tables and columns... This may take several minutes for large databases.
        </small>
    </div>
    
    <!-- Continue polling for updates -->
    <div hx-get="{% url 'thoth_ai_backend:check_preprocessing_status' workspace.id %}"
         hx-trigger="load delay:1s"
         hx-target="#{{ container_id|default:'preprocessing-container' }}"
         hx-swap="outerHTML"></div>
</div>